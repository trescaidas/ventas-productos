<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#271040">
<title>Venta de Productos &mdash; Hermandad</title>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --morado:#271040; --morado-med:#3b1f5e; --morado-claro:#5a3080;
  --verde:#1a4a2e; --verde-claro:#2d7a4a;
  --plata:#e8e0f0; --crema:#f7f4fb; --crema-med:#ece5f5;
  --gris:#7a7088; --gris-claro:#c8c0d4; --blanco:#fdfbff; --rojo:#c0392b;
  --sombra:0 4px 20px rgba(39,16,64,0.15);
}
html{height:100%;-webkit-tap-highlight-color:transparent}
body{min-height:100vh;min-height:100dvh;font-family:system-ui,Arial,sans-serif;
  background:var(--morado);color:var(--blanco);font-size:16px;line-height:1.5;
  display:flex;flex-direction:column}
.cab{background:linear-gradient(180deg,#1a0d2e,var(--morado));
  padding:max(env(safe-area-inset-top),14px) 18px 14px;
  display:flex;align-items:center;gap:12px;
  border-bottom:1px solid rgba(200,192,216,0.1);
  position:sticky;top:0;z-index:10}
.cab img{width:36px;height:36px;object-fit:contain;filter:drop-shadow(0 0 5px rgba(45,122,74,0.6));flex-shrink:0}
.cab-t{font-family:Georgia,serif;font-size:17px;font-weight:700;color:var(--plata);line-height:1.1}
.cab-s{font-size:10px;color:rgba(200,192,216,0.45);letter-spacing:1.5px;text-transform:uppercase}
.cab-st{margin-left:auto;display:flex;align-items:center;gap:5px;font-size:11px;color:rgba(200,192,216,0.4)}
.dot{width:6px;height:6px;border-radius:50%;background:var(--morado-claro);box-shadow:0 0 6px var(--morado-claro);animation:pb 2s ease-in-out infinite}
@keyframes pb{0%,100%{opacity:1}50%{opacity:.3}}
.body{flex:1;padding:16px;display:flex;flex-direction:column;gap:12px;
  padding-bottom:max(env(safe-area-inset-bottom),20px)}
.resumen{background:rgba(255,255,255,0.06);border:1px solid rgba(200,192,216,0.1);
  border-radius:14px;display:grid;grid-template-columns:repeat(3,1fr)}
.ri{padding:12px 6px;text-align:center}
.ri+.ri{border-left:1px solid rgba(200,192,216,0.1)}
.ri-val{font-family:Georgia,serif;font-size:18px;font-weight:700;line-height:1}
.ri-lbl{font-size:9px;color:var(--gris-claro);text-transform:uppercase;letter-spacing:1px;margin-top:3px}
.ri-n{font-size:9px;color:rgba(200,192,216,0.35);margin-top:1px}
.form{background:var(--blanco);border-radius:18px;padding:18px;display:flex;flex-direction:column;gap:14px}
.imp-blq{text-align:center;padding:4px 0}
.imp-lbl{font-size:10px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:var(--gris);display:block;margin-bottom:6px}
.imp-wrap{display:flex;align-items:center;justify-content:center;gap:2px}
.imp-eur{font-family:Georgia,serif;font-size:34px;font-weight:700;color:var(--gris);margin-top:6px}
#importe{border:none;outline:none;font-family:Georgia,serif;font-size:50px;font-weight:700;
  color:var(--morado);width:170px;text-align:center;background:transparent;
  border-bottom:3px solid var(--crema-med);transition:border-color .2s;padding:0 4px}
#importe:focus{border-bottom-color:var(--morado-claro)}
#importe::placeholder{color:var(--gris-claro)}
.sep{height:1px;background:var(--crema-med);margin:0 -18px}
.sec-lbl{font-size:10px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:var(--gris)}
.pbtns{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:10px}
.pb{padding:13px 6px;border:2px solid var(--crema-med);border-radius:12px;
  background:var(--crema);color:var(--gris);font-size:12px;font-weight:700;
  cursor:pointer;font-family:system-ui,Arial,sans-serif;transition:all .15s;
  display:flex;flex-direction:column;align-items:center;gap:3px;user-select:none;-webkit-user-select:none}
.pb .pi{font-size:20px}
.pb:active{transform:scale(.95)}
.pb.s-ef{background:var(--verde);border-color:var(--verde);color:#e0f5ea}
.pb.s-tpv{background:var(--morado-med);border-color:var(--morado-med);color:var(--plata)}
.pb.s-biz{background:#0055cc;border-color:#0044aa;color:white}
#desc{width:100%;padding:11px 13px;border:2px solid var(--crema-med);border-radius:11px;
  font-size:15px;font-family:system-ui,Arial,sans-serif;background:var(--crema);
  color:#0d0a0f;outline:none;resize:none;transition:border-color .2s}
#desc:focus{border-color:var(--morado-claro)}
#desc::placeholder{color:var(--gris-claro)}
.btn-g{width:100%;padding:17px;border:none;border-radius:13px;
  background:linear-gradient(135deg,var(--morado),var(--morado-claro));
  color:white;font-size:16px;font-weight:700;font-family:system-ui,Arial,sans-serif;
  cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:8px;
  box-shadow:0 4px 14px rgba(39,16,64,0.4);letter-spacing:.3px}
.btn-g:active:not(:disabled){transform:scale(.98)}
.btn-g:disabled{opacity:.5;cursor:not-allowed}
.hist-tit{font-size:11px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;
  color:rgba(200,192,216,0.4);padding:0 2px}
.hist{display:flex;flex-direction:column;gap:6px}
.hi{background:rgba(255,255,255,0.05);border:1px solid rgba(200,192,216,0.08);
  border-radius:11px;padding:11px 13px;display:flex;align-items:center;gap:11px}
.hi-ico{width:34px;height:34px;border-radius:8px;display:flex;align-items:center;
  justify-content:center;font-size:15px;flex-shrink:0}
.hi-ico.ef{background:rgba(26,74,46,0.35)}
.hi-ico.tpv{background:rgba(59,31,94,0.45)}
.hi-ico.biz{background:rgba(0,85,204,0.3)}
.hi-inf{flex:1;min-width:0}
.hi-imp{font-family:Georgia,serif;font-size:16px;font-weight:700;color:var(--plata)}
.hi-det{font-size:10px;color:rgba(200,192,216,0.45);margin-top:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.hi-h{font-size:10px;color:rgba(200,192,216,0.3);text-align:right;flex-shrink:0}
.sin-reg{text-align:center;color:rgba(200,192,216,0.25);font-size:13px;padding:14px;font-style:italic}
.overlay{display:none;position:fixed;inset:0;background:rgba(39,16,64,0.78);
  z-index:100;align-items:center;justify-content:center;padding:20px}
.overlay.v{display:flex;animation:mf .15s ease}
@keyframes mf{from{opacity:0}to{opacity:1}}
.mbox{background:var(--blanco);border-radius:18px;padding:26px 22px;width:100%;max-width:320px;
  text-align:center;border-top:5px solid var(--rojo);animation:mu .2s ease}
@keyframes mu{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.m-ico{font-size:38px;margin-bottom:8px}
.m-tit{font-family:Georgia,serif;font-size:17px;font-weight:700;color:var(--rojo);margin-bottom:6px}
.m-msg{font-size:14px;color:#333;line-height:1.5;margin-bottom:18px}
.m-btn{background:var(--rojo);color:white;border:none;border-radius:10px;padding:12px;
  font-size:15px;font-weight:700;cursor:pointer;font-family:system-ui,Arial,sans-serif;width:100%}
#toasts{position:fixed;top:74px;left:50%;transform:translateX(-50%);z-index:200;
  display:flex;flex-direction:column;align-items:center;gap:8px;pointer-events:none;width:88%}
.toast{padding:11px 18px;border-radius:11px;font-size:14px;font-weight:600;
  box-shadow:0 6px 24px rgba(39,16,64,0.3);animation:ts .3s ease;text-align:center;width:100%}
@keyframes ts{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}
.toast.ok{background:var(--morado-med);color:white}
.toast.err{background:var(--rojo);color:white}
.sp{display:inline-block;width:16px;height:16px;border:2px solid rgba(255,255,255,.3);
  border-top-color:white;border-radius:50%;animation:spin .7s linear infinite;vertical-align:middle}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>
<div class="cab">
  <img src="data:image/png;base64,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" alt="Escudo" />
  <div><div class="cab-t">Venta de Productos</div><div class="cab-s">Hermandad de las Tres Ca&#237;das</div></div>
  <div class="cab-st"><div class="dot"></div><span id="est">listo</span></div>
</div>
<div class="body">
  <div class="resumen">
    <div class="ri"><div class="ri-val" style="color:#4caf7d" id="rs-ef">0,00</div><div class="ri-lbl">Efectivo</div><div class="ri-n" id="rs-ef-n">0 ventas</div></div>
    <div class="ri"><div class="ri-val" style="color:var(--plata)" id="rs-tpv">0,00</div><div class="ri-lbl">TPV</div><div class="ri-n" id="rs-tpv-n">0 ventas</div></div>
    <div class="ri"><div class="ri-val" style="color:#6699ff" id="rs-biz">0,00</div><div class="ri-lbl">Bizum</div><div class="ri-n" id="rs-biz-n">0 ventas</div></div>
  </div>
  <div class="form">
    <div class="imp-blq"><span class="imp-lbl">Importe</span>
      <div class="imp-wrap"><span class="imp-eur">&#8364;</span>
      <input type="number" id="importe" placeholder="0,00" min="0.01" step="0.01" inputmode="decimal" /></div>
    </div>
    <div class="sep"></div>
    <div><div class="sec-lbl">Forma de pago</div>
    <div class="pbtns">
      <button class="pb" onclick="selP('Efectivo',this,'ef')"><span class="pi">&#128181;</span>Efectivo</button>
      <button class="pb" onclick="selP('TPV (tarjeta)',this,'tpv')"><span class="pi">&#128179;</span>TPV</button>
      <button class="pb" onclick="selP('Bizum',this,'biz')"><span class="pi">&#128242;</span>Bizum</button>
    </div></div>
    <div class="sep"></div>
    <div><div class="sec-lbl" style="margin-bottom:9px">Descripci&#243;n <span style="font-weight:400;text-transform:none;letter-spacing:0;font-size:11px;color:var(--gris-claro)">(opcional)</span></div>
    <textarea id="desc" rows="2" placeholder="A&#241;ade una nota si lo necesitas..."></textarea></div>
    <button class="btn-g" id="btn-g" onclick="guardar()">&#10003; Guardar registro</button>
  </div>
  <div class="hist-tit">Registros de hoy</div>
  <div class="hist" id="hist"></div>
</div>
<div class="overlay" id="modal" onclick="cM(event)">
  <div class="mbox"><div class="m-ico">&#9888;&#65039;</div>
  <div class="m-tit">Falta informaci&#243;n</div>
  <div class="m-msg" id="mmsg"></div>
  <button class="m-btn" onclick="cM()">Entendido</button></div>
</div>
<div id="toasts"></div><script>
// ══════════════════════════════════════════════════════
// CAMBIA ESTA URL por la de tu Apps Script receptor:
var URL_RECEPTOR = 'https://script.google.com/macros/s/AKfycby4DqYlSkY_V3rY006_9wRNJOHIiSQEezBTnkB4Y1lFl2RzAIvNe-YNdfX75wy_VlD1/exec';
// ══════════════════════════════════════════════════════

var formaPago = '';
var KR = 'htc_prod_';

function hoy() {
  var d = new Date();
  return d.getFullYear() + '-' + (d.getMonth()+1) + '-' + d.getDate();
}
function cargarLocal() {
  try { var s = localStorage.getItem(KR+hoy()); return s ? JSON.parse(s) : []; } catch(e) { return []; }
}
function saveLocal(arr) {
  try {
    localStorage.setItem(KR+hoy(), JSON.stringify(arr));
    for (var i = 0; i < localStorage.length; i++) {
      var k = localStorage.key(i);
      if (k && k.indexOf('htc_prod_')===0 && k.indexOf(hoy())<0) { localStorage.removeItem(k); i--; }
    }
  } catch(e) {}
}

var registros = cargarLocal();
actualizarUI();

function selP(forma, btn, cls) {
  formaPago = formaPago === forma ? '' : forma;
  document.querySelectorAll('.pb').forEach(function(b) { b.className = 'pb'; });
  if (formaPago) btn.className = 'pb s-' + cls;
}
function cM(e) {
  if (!e || e.target===document.getElementById('modal') || e.target.classList.contains('m-btn'))
    document.getElementById('modal').classList.remove('v');
}
function mostrarError(msg) {
  document.getElementById('mmsg').textContent = msg;
  document.getElementById('modal').classList.add('v');
}

function guardar() {
  var imp = parseFloat(document.getElementById('importe').value);
  if (!imp || imp <= 0) { mostrarError('Introduce un importe v\u00e1lido mayor que cero.'); return; }
  if (!formaPago)       { mostrarError('Selecciona la forma de pago antes de guardar.'); return; }
  var desc = document.getElementById('desc').value.trim();

  var btn = document.getElementById('btn-g');
  btn.disabled = true;
  btn.innerHTML = '<span class="sp"></span> Guardando...';

  fetch(URL_RECEPTOR, {
    method: 'POST',
    mode: 'no-cors',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ importe: imp, formaPago: formaPago, descripcion: desc })
  })
  .then(function() {
    btn.disabled = false;
    btn.innerHTML = '&#10003; Guardar registro';
    var hora = new Date().toLocaleTimeString('es-ES', {hour:'2-digit', minute:'2-digit'});
    registros.unshift({ hora:hora, imp:imp, forma:formaPago, desc:desc });
    saveLocal(registros);
    actualizarUI();
    toast('Registro guardado correctamente', 'ok');
    document.getElementById('importe').value = '';
    document.getElementById('desc').value = '';
    document.querySelectorAll('.pb').forEach(function(b) { b.className = 'pb'; });
    formaPago = '';
  })
  .catch(function() {
    btn.disabled = false;
    btn.innerHTML = '&#10003; Guardar registro';
    mostrarError('Error de conexi\u00f3n. Verifica tu internet e int\u00e9ntalo de nuevo.');
  });
}

function actualizarUI() {
  var ef=0,nef=0,tv=0,ntv=0,bz=0,nbz=0;
  registros.forEach(function(r) {
    if (r.forma==='Efectivo')   { ef+=r.imp; nef++; }
    else if (r.forma==='Bizum') { bz+=r.imp; nbz++; }
    else                        { tv+=r.imp; ntv++; }
  });
  function fmt(n) { return n.toFixed(2).replace('.',','); }
  document.getElementById('rs-ef').innerHTML  = fmt(ef);
  document.getElementById('rs-ef-n').textContent = nef+(nef===1?' venta':' ventas');
  document.getElementById('rs-tpv').innerHTML = fmt(tv);
  document.getElementById('rs-tpv-n').textContent = ntv+(ntv===1?' venta':' ventas');
  document.getElementById('rs-biz').innerHTML = fmt(bz);
  document.getElementById('rs-biz-n').textContent = nbz+(nbz===1?' venta':' ventas');

  var h = document.getElementById('hist');
  if (registros.length===0) { h.innerHTML='<div class="sin-reg">A\u00fan no hay registros hoy</div>'; return; }
  h.innerHTML = registros.slice(0,25).map(function(r) {
    var cls = r.forma==='Efectivo'?'ef': r.forma==='Bizum'?'biz':'tpv';
    var ico = r.forma==='Efectivo'?'&#128181;': r.forma==='Bizum'?'&#128242;':'&#128179;';
    return '<div class="hi">'+
      '<div class="hi-ico '+cls+'">'+ico+'</div>'+
      '<div class="hi-inf">'+
        '<div class="hi-imp">'+r.imp.toFixed(2).replace('.',',')+' &#8364;</div>'+
        '<div class="hi-det">'+r.forma+(r.desc?' &middot; '+r.desc:'')+'</div>'+
      '</div>'+
      '<div class="hi-h">'+r.hora+'</div>'+
    '</div>';
  }).join('');
}

function toast(msg, tipo) {
  var c=document.getElementById('toasts'), t=document.createElement('div');
  t.className='toast '+tipo; t.innerHTML=msg; c.appendChild(t);
  setTimeout(function(){ t.style.transition='opacity .3s'; t.style.opacity='0'; setTimeout(function(){t.remove();},300); },3500);
}
</script>
</body>
</html>
